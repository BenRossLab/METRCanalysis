##########################################################################################################
##### DESCRIPTION                                                                                    #####
##### Code for preliminary processing of .fastq files from Illumina sequencing. Processing includes: #####
##### 1. standard DADA2 pipeline                                                                     #####
##### 2. assigning taxonomy using a modified silva_nr_v132 database                                  #####
##### 3. passing data into phyloseq object                                                           #####
##### 4. correcting a few mis-identified important taxa                                              #####
##### 5. adding columns to mapping file based on calculations from processed sequencing data         #####
##### 6. final output = physeqR                                                                      ##### 
##### Use this file to prepare initial raw phyloseq object for all future downstream analysis.       #####
##########################################################################################################

#####################################################################
########## Processing Set âˆ’up #######################################
#####################################################################
# R version 4.5.2 (2025-10-31) -- "[Not] Part in a Rumble"
# All code written by Emily Ann McClure. No AI was used at any stage in writing or editing this code. 
########## Call libraries for use ##########
# Packages from CRAN
library("ggplot2") # version 4.0.0
library("data.table") # version 1.17.8
library("dplyr") # version 1.1.4

# Packages from Bioconductor
library("phyloseq") # version 1.52.0
library("decontam") # version 1.28.0 # identify contaminant ASVs 
library("dada2") # version 1.36.0

path <- "~/Desktop/Wannigan_METRC/" # change this to directory where you will be working
setwd(path) # set working directory
dir.create("outputPrelim") # create directory for output files to go
dir.create("plots") # create directory for plots to go

################################################################################
##### ASV assignment with DADA2 ################################################
################################################################################
fnFs <- sort(list.files(paste0(path,"raw/16S/"), pattern="R1_001", full.names = TRUE))
fnRs <- sort(list.files(paste0(path,"raw/16S/"), pattern="R2_001", full.names = TRUE))

if(length(fnFs) != length(fnRs)) stop("At least one sample is unpaired. Please check forward and reverse reads are present for all samples")

sample.names <- sapply(strsplit(basename(fnFs), "_"), `[`, 1)
#sample.namesR <- sapply(strsplit(basename(fnRs), "_"), `[`, 1) # to check if reverse reads have same sample names as forward
#write.csv(sample.names,"outputPrelim/sampleNames.csv") # print list of sample names to check if they match map file
table_map <- data.frame(read.csv("raw/table_map.csv", header = TRUE, row.names = 1, check.names=FALSE)) # reads csv file into data.frame with row names in column 1

save(fnFs,file=("outputPrelim/output_fnFs.RData")) # Save in a .RData file 
save(fnRs,file=("outputPrelim/output_fnRs.RData")) # Save in a .RData file 

filtFs <- file.path(path, "filtered", paste0(sample.names, "_F_filt.fastq.gz"))
filtRs <- file.path(path, "filtered", paste0(sample.names, "_R_filt.fastq.gz"))
names(filtFs) <- sample.names
names(filtRs) <- sample.names
save(filtFs,file=("outputPrelim/output_filtFs.RData")) # Save in a .RData file
save(filtRs,file=("outputPrelim/output_filtRs.RData")) # Save in a .RData file

filtered <- filterAndTrim(fnFs, filtFs, 
                          fnRs, filtRs,
                          trimLeft=21, trimRight=0,
                          maxLen=530, minLen = 150,
                          maxN=0, maxEE=c(3,5), truncQ=2, rm.phix=TRUE,
                          compress=TRUE, verbose=TRUE, multithread=TRUE) # filtering values set here are specific to this study. Modify as appropriate when sequencing other regions.
save(filtered,file=("outputPrelim/output_filtered.RData")) # Save .RData file

### Subset filtFs and filtRs to include files with > 0 reads (some files may have been emptied during error analysis) 
filtFs <- filtFs[file.exists(filtFs)]
filtRs <- filtRs[file.exists(filtRs)]
save(filtFs,file=("outputPrelim/output_filtFs.RData")) # Save .RData file
save(filtRs,file=("outputPrelim/output_filtRs.RData")) # Save .RData file 

errF <- learnErrors(filtFs, multithread=TRUE)
errR <- learnErrors(filtRs, multithread=TRUE)
save(errF,file=("outputPrelim/output_errF.RData")) # Save .RData file
save(errR,file=("outputPrelim/output_errR.RData")) # Save .RData file
#plotErrors(errF, nominalQ=TRUE)

dadaFs <- dada(filtFs, err=errF, multithread=TRUE)
dadaRs <- dada(filtRs, err=errR, multithread=TRUE)
mergers <- mergePairs(dadaFs, filtFs, dadaRs, filtRs, verbose=TRUE)
save(dadaFs,file=("outputPrelim/output_dadaFs.RData")) # Save in a .RData file
save(dadaRs,file=("outputPrelim/output_dadaRs.RData")) # Save in a .RData file
save(mergers,file=("outputPrelim/output_mergers.RData")) # Save in a .RData file

seqtab <- makeSequenceTable(mergers)
# table(nchar(getSequences(seqtab))) # use to check distribution of sequence lengths
seqtab.all <- seqtab[,nchar(colnames(seqtab)) %in% 425:525] # these cut-off values have been chosen specific to this study. Modify as appropriate when sequencing other regions.
#seqtab.all <- seqtab[,nchar(colnames(seqtab)) %in% val.minLength:val.maxLength]
seqtab.noBim <- removeBimeraDenovo(seqtab.all, method="consensus", multithread=TRUE)

getNreads <- function(x) sum(getUniques(x))
track <- cbind(filtered, sapply(dadaFs, getNreads), sapply(dadaRs, getNreads), sapply(mergers, getNreads), rowSums(seqtab), rowSums(seqtab.noBim))
colnames(track) <- c("input", "filtered", "denoisedF", "denoisedR", "merged", "tabled", "nonBim")
track
#####################################################################
########## Transfer data into Phyloseq ##############################
##### This preliminary Phyloseq object will be used to trim #########
##### singletons from the dataset before assigning taxonomy #########
#####################################################################

OTUraw = otu_table(seqtab.noBim, taxa_are_rows=FALSE) # assigns ASV table from DADA output
MAP = sample_data(table_map) # reads csv file into data.frame with row names in column 1
phyW = phyloseq(OTUraw, MAP) # prepare phyloseq object
save(phyW, file=("outputPrelim/physeq_raw.RData"))
save(OTUraw,file=("outputPrelim/output_otuRaw.RData")) # Save the phyloseq data object in a .RData file 

taxRaw <- assignTaxonomy(OTUraw, "~/Masters/silva_nr_v132_train_set_RossMod.fa", multithread=TRUE) # assign taxonomy to trimmed dataset
save(taxRaw,file=("outputPrelim/output_taxRaw.RData")) # Save the phyloseq data object in a .RData file 

#####################################################################
########## Transfer data into Phyloseq ##############################
#####################################################################
#load("outputPrelim/output_otuRaw.RData")
#load("outputPrelim/output_taxRaw.RData")
#table_map <- data.frame(read.csv("raw/table_map.csv", header = TRUE, row.names = 1, check.names=FALSE)) # reads csv file into data.frame with row names in column 1

OTU = otu_table(OTUraw, taxa_are_rows=FALSE) # assigns ASV table from trimmed DADA output
TAX = tax_table(taxRaw) # assigns taxonomy table
MAP = sample_data(table_map) # reads csv file into data.frame with row names in column 1
physeq = phyloseq(OTU, TAX, MAP) # prepare phyloseq object

### create and assign ASV numbers to consensus sequences for easier reference ###
ASV <- paste0("ASV", seq(ntaxa(physeq))) 
Sequence <- row.names(tax_table(physeq)) 
bind.asv <- cbind(tax_table(physeq),ASV)
bind.seq <- cbind(bind.asv,Sequence) 
TAX2 = tax_table(as.matrix(bind.seq)) # define new taxonomy table
colnames(TAX2) <- c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus", "Species","Strain","ASV","Sequence")
physeqR = phyloseq(OTU, TAX2, MAP) # prepare phyloseq object modified with ASV numbers
taxa_names(physeqR) <- tax_table(physeqR)[,"ASV"]

################################################################################################
##### Correct a few non=specific sequences and other mis-identifications in taxonomy table #####
################################################################################################
seqs.Enterobacter <- c("TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAGAGAGCTTGCTCTCGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATAACGTCGCAAGACCAAAGAGGGGGACCTTCGGGCCTCTTGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAACGGCTCACCTAGGCGACGATCCCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGGGGAGGAAGGCGATAAGGTTAATAACCTTGTCGATTGACGTTACCCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                       "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAACGGTAGCACAGAGAGCTTGCTCTCGGGTGACGAGTGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATAATGTCGCAAGACCAAAGAGGGGGACCTTCGGGCCTCTTGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAACGGCTCACCTAGGCGACGATCCCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGGGGAGGAAGGCGGTGAGGTTAATAACCTCATCGATTGACGTTACCCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                       "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAGAGAGCTTGCTCTCGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATAACGTCGCAAGACCAAAGAGGGGGACCTTCGGGCCTCTTGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAACGGCTCACCTAGGCGACGATCCCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGAAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGGGGAGGAAGGCGATAAGGTTAATAACCTTGTCGATTGACGTTACCCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                       "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAACGGTAGCACAGAGAGCTTGCTCTCGGGTGACGAGTGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTATTGGAAACGGTAGCTAATACCGCATAACGTCGCAAGACCAAAGAGGGGGACCTTCGGGCCTCTTGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAACGGCTCACCTAGGCGACGATCCCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGGGGAGGAAGGCGGTGAGGTTAATAACCTCATCGATTGACGTTACCCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                       "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAACGGTAGCACAGAGAGCTTGCTCTCGGGTGACGAGTGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATAACGTCGCAAGACCAAAGAGGGGGACCTTCGGACCTCTTGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAACGGCTCACCTAGGCGACGATCCCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGGGGAGGAAGGCGGTGAGGTTAATAACCTCATCGATTGACGTTACCCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                       "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAACGGTAACAGGAAGCAGCTTGCTGCTTTGCTGACGAGTGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATAACGTCGCAAGACCAAAGAGGGGGACCTTCGGGCCTCTTGCCATCGGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAACGGCTCACCTAGGCGACGATCCCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGGGGAGGAAGGTGTTGAGGTTAATAACCTCAGCAATTGACGTTACCCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC")
seqs.Rhizobium <- c("TGGCTCAGAACGAACGCTGGCGGCAGGCTTAACACATGCAAGTCGAACGCCCCGCAAGGGGAGTGGCAGACGGGTGAGTAACGCGTGGGAACATACCCTTTCCTGCGGAATAGCTCCGGGAAACTGGAATTAATACCGCATACGCCCTACGGGGGAAAGATTTATCGGGGAAGGATTGGCCCGCGTTGGATTAGCTAGTTGGTGGGGTAAAGGCCTACCAAGGCGACGATCCATAGCTGGTCTGAGAGGATGATCAGCCAAATTGGGACTGAGACACGGCCCAAACTCCTACGGGAGGCAGCAGTGGGGAATATTGGACAATGGGCGCAAGCCTGATCCAGCCATGCCGCGTGAGTGATGAAGGCCTTAGGGTTGTAAAGCTCTTTCACCGGAGAAGATAATGACGGTATCCGGAGAAGAAGCCCCGGCTAACTTCGTGCCAGC",
                        "TGGCTCAGAACGAACGCTGGCGGCAGGCTTAACACATGCAAGTCGAACGCCCCGCAAGGGGAGTGGCAGACGGGTGAGTAACGCGTGGGAACATACCCTTTCCTGCGGAATAGCTCCGGGAAACTGGAATTAATACCGCATACGCCCTACGGGGGAAAGATTTATCGGGGAAGGATTGGCCCGCGTTGGATTAGCTAGTTGGTGGGGTAAAGGCCTACCAAGGCGACGATCCATAGCTGGTCTGAGAGGATGATCAGCCACATTGGGACTGAGACACGGCCCAAACTCCTACGGGAGGCAGCAGTGGGGAATATTGGACAATGGGCGCAAGCCTGATCCAGCCATGCCGCGTGAGTGATGAAGGCCTTAGGGTTGTAAAGCTCTTTCACCGGAGAAGATAATGACGGTATCCGGAGAAGAAGCCCCGGCTAACTTCGTGCCAGC",
                        "TGGCTCAGAACGAACGCTGGCGGCAGGCTTAACACATGCAAGTCGAACGCCCCGCAAGGGGAGTGGCAGACGGGTGAGTAACGCGTGGGAACATACCCTTTCCTGCGGAATAGCTCCGGGAAACTGGAATTAATACCGCATACGCCCTACGGGGGAAAGATTTATCGGGGAAGGATTGGCCCGCGTTGGATTAGCTAGTTGGTGGGGTAAAGGCCTACCAAGGCGACGATCCATAGCTGGTTTGAGAGGATGATCAGCCACATTGGGACTGAGACACGGCCCAAACTCCTACGGGAGGCAGCAGTGGGGAATATTGGACAATGGGCGCAAGCCTGATCCAGCCATGCCGCGTGAGTGATGAAGGCCTTAGGGTTGTAAAGCTCTTTCACCGGAGAAGATAATGACGGTATCCGGAGAAGAAGCCCCGGCTAACTTCGTGCCAGC",
                        "TGGCTCAGAACGAACGCTGGCGGCAGGCTTAACACATGCAAGTCGAACGCCCCGCAAGGGGAGTGGCAGACGGGTGAGTAACGCGTGGGAACATACCCTTTCCTGCGGAATAGCTCCGGGAAACTGGAATTAATACCGCATACGCCCTACGGGGGAAAGATTTATCGGGGAAGGATTGGCCCGCGTTGGATTAGCTAGTTGGTGGGGTAAAGGCCTACCAAGGCGACGATCCATAGCTGGTCTGAGAGGATGATCAGCCACATTGGGACTGAGACACGGCCCAAACTCCTACGGGAGGCAGCAGTGTGGAATATTGGACAATGGGCGCAAGCCTGATCCAGCCATGCCGCGTGAGTGATGAAGGCCTTAGGGTTGTAAAGCTCTTTCACCGGAGAAGATAATGACGGTATCCGGAGAAGAAGCCCCGGCTAACTTCGTGCCAGC",
                        "TGGCTCAGAACGAACGCTGGCGGCAGGCTTAACACATGCAAGTCGAGCGCCCCGCAAGGGGAGCGGCAGACGGGTGAGTAACGCGTGGGAACATACCCTTTCCTGCGGAATAGCTCCGGGAAACTGGAATTAATACCGCATACGCCCTACGGGGGAAAGATTTATCGGGGAAGGATTGGCCCGCGTTGGATTAGCTAGTTGGTGGGGTAAAGGCCTACCAAGGCGACGATCCATAGCTGGTCTGAGAGGATGATCAGCCACATTGGGACTGAGACACGGCCCAAACTCCTACGGGAGGCAGCAGTGGGGAATATTGGACAATGGGCGCAAGCCTGATCCAGCCATGCCGCGTGAGTGATGAAGGCCTTAGGGTTGTAAAGCTCTTTCACCGGAGAAGATAATGACGGTATCCGGAGAAGAAGCCCCGGCTAACTTCGTGCCAGC",
                        "TGGCTCAGAACGAACGCTGGCGGCAGGCTTAACACATGCAAGTCGAACGCTCCGCAAGGAGAGTGGCAGACGGGTGAGTAACACGTGGGAACGTACCCTTTACTACGGAACAACTCCGGGAAACTGGAGCTAATACCGTATGTGCCCTTCGGGGGAAAGATTTATCGGTAAAGGATCGGCCCGCGTTGGATTAGCTAGTTGGTGGGGTAAAGGCCTACCAAGGCGACGATCCATAGCTGGTCTGAGAGGATGATCAGCCACATTGGGACTGAGACACGGCCCAAACTCCTACGGGAGGCAGCAGTGGGGAATATTGGACAATGGGCGCAAGCCTGATCCAGCCATGCCGCGTGTGTGATGAAGGCCTTAGGGTTGTAAAGCACTTTCACCGGAGAAGATAATGACGGTATCCGGAGAAGAAGCCCCGGCTAACTTCGTGCCAGC",
                        "TGGCTCAGAACGAACGCTGGCGGCAGGCTTAACACATGCAAGTCGAGCGCCCCGCAAGGGGAGCGGCAGACGGGTGAGTAACGCGTGGGAATCTACCCTTTTCTACGGAATAACGCAGGGAAACTTGTGCTAATACCGTATGTGTCCTTCGGGAGAAAGATTTATCGGGAAAGGATGAGCCCGCGTTGGATTAGCTAGTTGGTGGGGTAAAGGCCTACCAAGGCGACGATCCATAGCTGGTCTGAGAGGATGATCAGCCACATTGGGACTGAGACACGGCCCAAACTCCTACGGGAGGCAGCAGTGGGGAATATTGGACAATGGGCGCAAGCCTGATCCAGCCATGCCGCGTGAGTGATGAAGGCCCTAGGGTTGTAAAGCTCTTTCACCGGAGAAGATAATGACGGTATCCGGAGAAGAAGCCCCGGCTAACTTCGTGCCAGC")
seqs.Hparalvei <- c("TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGACGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGATGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGACGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACACCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGATGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATCAAGGTTAATAACCTTGGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGACGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATCAAGGTTAATAACCTTGGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATAACGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGACGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCACACGGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGACGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGGCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGACGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACGGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGATGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGGGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGATGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCACACGGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGACGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCGACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGACGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACGCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGACGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCAAACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGATGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCAAACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGATGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACGGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGACGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGGGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGACGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCCGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGACGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCGGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGACGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGTGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGACGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGTAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGACGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAAGGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGACGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGAAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGACGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACCCGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGATGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAAGGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGATGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACCCGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGACGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGAGGGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC",
                    "TGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAGCGGTAGCACAAGAGAGCTTGCTCTCTGGGTGACGAGCGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATGACGTCTTCGGACCAAAGTGGGGGACCTTCGGGCCTCACGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAATGGCTCACCTAGGCGACGATCTCTAGCTGGTCTGGGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGAGGAGGAAGGCATTAAGGTTAATAACCTTAGTGATTGACGTTACTCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGC")

ls.homo <- read.csv("raw/list_homoASVs.csv", header = FALSE, check.names=FALSE)[,1] # reads csv file into list

df.taxRaw <- as.data.frame(tax_table(physeqR))
df.homo <- df.taxRaw[grepl("TGGCTCATTAAA|TGGCTCAGCCTCCC|TGGCTCAGCCTCTC|TGGCTCAGCCTCCA|GCTGGGCTGGTGCAGAGG|TGGCTCATCAAG|TGGCTCAGTGTG|GCTGGCTCTGGC|TGGCTCAGCCCC|TGGCTCAGGCTA|TGGCTCACTGCA|TGTTTCCCCAGC|TGGCTCAGTCTG|TGGCTCATACCC|TGGCTCAGGGAT|TGGCTCAGAGAT|TGGCTCATATCT|TGGCTCAGCTAC|TGGCTCAGGACAGGG|TGGCTCAGCTGA|TGGCTCCACACT|TGGCTCTGGAGG|TGGCTCAGGTTT|TGGCTCATGAGA|TGGCTCATCATT|TGGCTCAGCCTC|TGGCTCACTGCA|TGGCTCCCCTCA|CTCAGCCTCCC|TGGCTCAGTGCT|TGGCTCAGGATC|TGGCTCACTGCA|TGGCTCAGTCTT|TACACTGAGCCA|TGGCTCAGTGTA|TGGCTCTGCATA|TGGCTCAGGTGT|TGGCTCAAGCAG|TGGCTCAGCCTA|TGGCTCAGAGGG|TGGCTCAGCAGG|TGGCTCAGTCAC|TGGCTCAGCGTG|TGGCTCAGGGAG|TGGCTCAGAGGC|TGGCTCAGTGCA|TGGCTCAGAGAC|TGGCTCAGGTAT|TGGCTCAAGGCA|TGGCTCAGGGTT|TGGCTCAGAATC|TGGCTCAGGAAG|TGGCTCAGCACT|TGGCTCACTGAA|TGGCTCAGACTG|TGGCTCAGAAGA|TGGCTCAGGACC|TGGCTCACCGTA|TGGCTCAGGCAG|TGGCTCCTTGTG|TGGCTCAGGGCA|TGGCTCAGCCTC|TGGCTCATTTGG|TGGCTCATACCC|TGGCTCAGTCCA|TGGCTCACCTAC|TGGCTCAATTCA|TGGCTCAGCTCA|TGGCTCAGAAAA|TGGCTCAGCTGG|TGGCTCAGTCTC|TGGCTCATTGCA|TGGCTCAGAGTT|TGGCTCACCATA|TGGCTCAGAGTA|TGGCTCACTCTA|TGGCTCAGAGCC|TGGCTCTACCAC|TGGCTCACCCCT|TGGCTCAAGAAC|TGGCTCAGCTTC|TGGCTCACTACA|TGGCTCAGGTCA|TGGCTCAGGGTG|TGGCTCAGCCCG|TGGCCCTCAAGG|TGGCTCAGGCTC|TGGCTCAGCTGA|TGGCTCAGGTGG|TGGCTCAGGATAACT|TGGCTCAGAAAT|TGGCTCAAGCAC|TGGCTCAAAAAG|TGGCTCCTGCAG|TGGCTCAAGGAA|TGGCTCAGAAGC|TGGCTCAGGCAC|TGGCTCATATTC|TGGCTCAGGTTT|TGGCTCACTGGC|TGGCTCAGGAAC|TGGCTCAGGAGG|TGGCTCAGACAG|TGGCTCAGTTTC|TGGCTCTGCCAC|TGGCTCAGTGGA|TGGCTCAGTGGG|TGGCTCAGGCCC|TGGCTCAGGTCT|TGGCTCAGCAGT|TGGCTCAAGTGA|TGGCTCTTTAAG|TGGCTCAGCCTT|TGGCTCAGGCAA|TGGCTCAGATGG|TGGCTCAGGCGG|TGGCTCAGTTAC|TGGCTCAGCAGA|TGGCTCAGACGT|TGGCTCAATGCA|TGGCTCAGGTGA|TGGCTCAGTTTA|TGGCTCAGAGAG|TGGCTCAGAACA|TGGCTCAGGTGC|TGGCTCAGGGCT|TGGCTCACTGAG|TGGCTCAGGGTC|TGGCTCAGGGAG|TGGCTCAGGGTT|TGGCTCAGAAGA|TGGCTCAATTCA|TGGCTCAGAGTT|TGGCTCACCCCT|TGGCTCAGCCCG|TGGCTCAGACCC|TGGCTCAGAATG|TGGCTCAGAAAT|TGGCTCAGGCAC|TGGCTCAGACAG|TGGCTCACTGTA|TGGCTCAGGTCT|TGGCTCAATGCA|TGGCTCAGGGCT|TGGCTCTGTGTC|TGGCTCAGAGGA|TGGCTCAGCAAA|TGGCTCAGCGGT|TGGCTCAGACAA|TGGCTCGCTCCT|TGGCTCAAAGTC|TGGCTCAGAGCA|TGGCTCAGGAGT|TGGCTCAAACTA|TGGCTCAGCCAT|TGGCTCAGAGCT|TGGCTCTCTGCG|TGGCTCAGCAGC|TGGCTCAGCCAC|TGGCTCAGAACC|TGGCTCAGCTCC|TGGCTCAAGCGA|TGGCTCAGACAC|TGGCTCAGGGCG|TGGCTCAGCATT|TGGCTCTGCTGC|TGGCTCTGTCGT|TGGCTCAAAAAA|TGGCTCAGCTGT|TGGCTCAGGCAT|TGGCTCAGATCA|TGGCTCATGGTG|TGGCTCCCACTA|TGGCTCACCGGA|TGGCTCACTGCC|GGCTCAGAGCCA|TGGCTCCAGACA|TGGCTCACACCC|TGGCTCACTCCT|TGGCTCAGACCT|TGGCTGCTGTGG|TGGCTCACAAGC|TGGCTCACTGCT|TGGCTCAGTTAG|TGGCTCAGTACG|TGGCTCCTAACT|TGGCTCACCACA|TGGCTCAGAAAG|TGGCTACCCCAC|TGGCTCAGGCCT|TGGCTCCAGGTA|TGGCTCAGCATG|TGGCTCATGTCT|TGGCTCAGCGAT|TGGCTCATGCCC|TGGCTCAGCACC|TGGCTCAGCGTA|CTCCTGCCTTAG|TGGCCTGTGAGG|TGGCTCTTGCCT|TGGCTCGCTGCA|TGGCTCAGCAAG|TGGCTCAGAGTC|TGGCTCGTTTGG|TGGCTCATCAGA|TGGCTGCAAGGC|TGGCTCTGGCAC|TGGCTCAGTAAA|TGGCTCAGATAG|TGGCTCAGAATGT|TGGCTCAGATTGT|TGGCTCAGTAGT|TGGCTCATGGCA|TGGCTCACTGGA|TTTCTCCTTTTC|TGGCTCAGAAGGT|TGGCTCAGAAGGG|TGGCTCACTTCA|TGGCTCAGGCTT|TGGCTCAACTCA|TGGCTCAGGATGT|TGGCTCAGTCCT|TGGCTCAGGCTG|TGGCTCATATGG|TGGCTCAGCATC|TGGCTCATCCCT|TGGCTGGAGTCT|TGGCTCAGATGC|TGGCTCACCCCA|TGGCTCACTCCA|TGGCTCTCTAGT|TGGCTCAGGAAA|TGGCTCAGGGGG|TGGCTGACTGGC|TGGCTCAAGCTC|TGGCTCCTGACA|TGGCTCATGTAG|TGGCTCAGTATC|TGGCTAACACGG|TGGCTCAAAAGC|TGGCTCAAGAGA|TGGCTCAATGAA|TGGCTCAGACGA|TGGCTCAGCCAA|TGGCTCAGGAGC|TGGCTCAGGTCC|TGGCTCATGTCA|TGGCTCATGTGC|TGGCTCGGCTCT|TGGCTGCACAGT|TGGCTCAGTCAT|TGGCTCACCTAA|TGGCTCAGTGGT|TGGCTCAGACAT", rownames( df.taxRaw ) ) , ]

df.taxRaw$Kingdom <- with(df.taxRaw, ifelse(Sequence%in%ls.homo, "Animalia", 
                                            ifelse(ASV%in%df.homo$ASV, "Animalia", Kingdom)))
df.taxRaw$Phylum <- with(df.taxRaw, ifelse(Sequence%in%ls.homo, "Chordata", 
                                           ifelse(ASV%in%df.homo$ASV, "Chordata", Phylum)))
df.taxRaw$Class <- with(df.taxRaw, ifelse(Sequence%in%ls.homo, "Mammalia", 
                                           ifelse(ASV%in%df.homo$ASV, "Mammalia", Class)))
df.taxRaw$Order <- with(df.taxRaw, ifelse(Sequence%in%ls.homo, "Primates", 
                                          ifelse(ASV%in%df.homo$ASV, "Primates", 
                                                 ifelse(Genus%in%c("Clostridium"),"Eubacteriales",
                                                        Order))))
df.taxRaw$Family <- with(df.taxRaw, ifelse(Sequence%in%ls.homo, "Hominidae", 
                                           ifelse(ASV%in%df.homo$ASV, "Hominidae", 
                                                  ifelse(Genus%in%c("Clostridium"), "Clostridiaceae",
                                                         Family))))
df.taxRaw$Genus <- with(df.taxRaw,ifelse(Sequence%in%seqs.Enterobacter,"Enterobacter",
                                         ifelse(Genus=="Escherichia/Shigella","Escherichia",
                                                ifelse(Genus%in%c("Clostridium_sensu_stricto_10","Clostridium_sensu_stricto_18"),"Clostridium",
                                                       ifelse(Genus=="DSSD61","unk_Nitrosomonadaceae",
                                                              ifelse(Genus=="Corynebacterium_1","Corynebacterium",
                                                                     ifelse(Genus=="JCM_18997","unk_Solirubrobacterales",
                                                                            ifelse(Genus=="Chelatococcus","Methylocella",
                                                                                   ifelse(Genus=="Lachnoclostridium","Enterocloster",
                                                                                          ifelse(Genus=="Enhydrobacter","Moraxella",
                                                                                                 ifelse(Sequence%in%seqs.Rhizobium, "Rhizobium",
                                                                                                        ifelse(Sequence%in%seqs.Hparalvei, "Hafnia",
                                                                                                               Genus))))))))))))
df.taxRaw$Genus <- with(df.taxRaw, ifelse(Sequence%in%ls.homo, "Homo", 
                                          ifelse(ASV%in%df.homo$ASV, "Homo", Genus)))
df.taxRaw$Species <- with(df.taxRaw, ifelse(Sequence%in%ls.homo, "sapiens", 
                                            ifelse(ASV%in%df.homo$ASV, "sapiens",
                                                   ifelse(Sequence%in%seqs.Hparalvei, "paralvei", 
                                                          Species))))
### Correct a few missed taxonomies
df.taxRaw$Family <- with(df.taxRaw, ifelse(Sequence%in%c("ACGAACGCTGGCGGCGTGCTTAACACATGCAAGTCGAGCGATGAAGCTTCCTTCGGGAAGTGGATTAGCGGCGGACGGGTGAGTAACACGTGGGTAACCTGCCTCAAAGTGGGGGATAGCCTTCCGAAAGGAAGATTAATACCGCATAATATGAGAGAATCGCATGATTTTCTTATCAAAGATTTATTGCTTTGAGATGGACCCGCGGCGCATTAGCTAGTTGGTAAGGTAACGGCTTACCAAGGCAACGATGCGTAGCCGACCTGAGAGGGTGATCGGCCACATTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCGCAATGGGGGAAACCCTGACGCAGCAACGCCGCGTGGGTGATGAAGGTCTTCGGATTGTAAAGCCCTGTTTTCTGGGACGATAATGACGGTACCAGAGGAGGAAGCCACGGCTAACTA",
                                                         "ACGAACGCTGGCGGCGTGCCTAACACATGCAAGTCGAGCGGGGGACTTTTAGTCCCTAGCGGCGGACGGGTGAGTAACACGTGGGTAACCTGCCTTGTAGAGGGGGATAGCCCTCCGAAAGGAGGATTAATACCGCATAATGTCATGCTGACGCATGTTAGCGTGACCAAAGGAGCAATCCGCTACAAGATGGACCCGCGGCGCATTAGCTGGTTGGTGAGGTAACGGCCCACCAAGGCAACGATGCGTAGCCGGCCTGAGAGGGTGACCGGCCACATTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGAAAGCCTGATGCAGCAACGCCGCGTGAGTGATGAAGGCCTTCGGGTTGTAAAGCTCTGTCTTCTGGGACGATAATGACGGTACCAGAGGAGGAAGCCACGGCTAACTA",
                                                         "ACGAACGCTGGCGGCGTGCCTAACACATGCAAGTCGAGCGATGAAGCTCCTTCGGGAGTGAATTAGCGGCGGACGGGTGAGTAACACGTGGGTAACCTGCCTCATAGAGGGGAATAGCCTCCCGAAAGGGAGATTAATACCGCATAAAGTATGAAGGTCGCATGACTTTTATACCAAAGGAGCAATCCGCTATGAGATGGACCCGCGGCGCATTAGCTAGTTGGTGAGGTAAGGGCTCACCAAGGCAACGATGCGTAGCCGACCTGAGAGGGTGATCGGCCACATTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCGCAATGGGGGAAACCCTGACGCAGCAACGCCGCGTGAATGAAGAAGGCCTTAGGGTTGTAAAGTTCTGTCATATGGGAAGATAATGACGGTACCATATGAGGAAGCCACGGCTAACTA"),"Clostridiaceae",
                                           ifelse(Sequence=="ACGAACGCTGGCGGCAGGCTTAACACATGCAAGTCGAACGCCCCGCAAGGGGAGTGGCAGACGGGTGAGTAACGCGTGGGAACATACCCTTTCCTGCGGAATAGCTCCGGGAAACTGGAATTAATACCGCATACGCCCTACGGGGGAAAGATTTATCGGGGAAGGATTGGCCCGCGTTGGATTAGCTAGTTGGTGGGGTAAAGGCCTACCAAGGCGACGATCCATAGCTGGTCTGAGAGGATGATCAGCCACATTGGGACTGAGACACGGCCCAAACTCCTACGGGAGGCAGCAGTGGGGAATATTGGACAATGGGCGCAAGCCTGATCCAGCCATGCCGCGTGAGTGATGAAGGCCTTAGGGTTGTAAAGCTCTTTCACCGGAGAAGATAATGACGGTATCCGGAGAAGAAGCCCCGGCTAACTT","Rhizobiaceae",
                                                  ifelse(Sequence=="ACGAACGCTGGCGGCGTGCTTAACACATGCAAGTCGAACGAGACAATTAAAAGCTTGCTTTTAAACGTCGAGTGGCAAACGGGTGAGTAACGCGTAGACAACCTGCCGCAAAGATGGGGACAACAGTTCGAAAGGACTGCTAATACCGAATGTTCTGGAAGTTCCGCATGGAAATTCCAGCAAAGATGGCCTCTACTTGTAAGCGATCGCTTTGCGATGGGTCTGCGTCTGATTAGCTAGTTGGTGGGGCAAGGGCCTACCAAGGCGACGATCAGTAGCCGGTCTGAGAGGATGAACGGCCACATTGGGACTGAGACACGGCCCAGACTCCTACGGGAGGCAGCAGTGGGGAATCTTCCGCAATGGGCGAAAGCCTGACGGAGCAACGCCGCGTGAGTGAAGAAGGTCTTCGGATCGTAAAGCTCTGTTGCCGGGGACGAATGTAGGCAATGCAAACAGCATTGTGTAATGACGGTACCCGGCGAGGAAGCCACGGCTAACTA","Selenomonadaceae",
                                                         Family))))
df.taxRaw$Genus <- with(df.taxRaw, ifelse(Sequence%in%c("ACGAACGCTGGCGGCGTGCTTAACACATGCAAGTCGAGCGATGAAGCTTCCTTCGGGAAGTGGATTAGCGGCGGACGGGTGAGTAACACGTGGGTAACCTGCCTCAAAGTGGGGGATAGCCTTCCGAAAGGAAGATTAATACCGCATAATATGAGAGAATCGCATGATTTTCTTATCAAAGATTTATTGCTTTGAGATGGACCCGCGGCGCATTAGCTAGTTGGTAAGGTAACGGCTTACCAAGGCAACGATGCGTAGCCGACCTGAGAGGGTGATCGGCCACATTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCGCAATGGGGGAAACCCTGACGCAGCAACGCCGCGTGGGTGATGAAGGTCTTCGGATTGTAAAGCCCTGTTTTCTGGGACGATAATGACGGTACCAGAGGAGGAAGCCACGGCTAACTA",
                                                        "ACGAACGCTGGCGGCGTGCCTAACACATGCAAGTCGAGCGGGGGACTTTTAGTCCCTAGCGGCGGACGGGTGAGTAACACGTGGGTAACCTGCCTTGTAGAGGGGGATAGCCCTCCGAAAGGAGGATTAATACCGCATAATGTCATGCTGACGCATGTTAGCGTGACCAAAGGAGCAATCCGCTACAAGATGGACCCGCGGCGCATTAGCTGGTTGGTGAGGTAACGGCCCACCAAGGCAACGATGCGTAGCCGGCCTGAGAGGGTGACCGGCCACATTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGAAAGCCTGATGCAGCAACGCCGCGTGAGTGATGAAGGCCTTCGGGTTGTAAAGCTCTGTCTTCTGGGACGATAATGACGGTACCAGAGGAGGAAGCCACGGCTAACTA",
                                                        "ACGAACGCTGGCGGCGTGCCTAACACATGCAAGTCGAGCGATGAAGCTCCTTCGGGAGTGAATTAGCGGCGGACGGGTGAGTAACACGTGGGTAACCTGCCTCATAGAGGGGAATAGCCTCCCGAAAGGGAGATTAATACCGCATAAAGTATGAAGGTCGCATGACTTTTATACCAAAGGAGCAATCCGCTATGAGATGGACCCGCGGCGCATTAGCTAGTTGGTGAGGTAAGGGCTCACCAAGGCAACGATGCGTAGCCGACCTGAGAGGGTGATCGGCCACATTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCGCAATGGGGGAAACCCTGACGCAGCAACGCCGCGTGAATGAAGAAGGCCTTAGGGTTGTAAAGTTCTGTCATATGGGAAGATAATGACGGTACCATATGAGGAAGCCACGGCTAACTA"),"Clostridium",
                                          ifelse(Sequence=="ACGAACGCTGGCGGCAGGCTTAACACATGCAAGTCGAACGCCCCGCAAGGGGAGTGGCAGACGGGTGAGTAACGCGTGGGAACATACCCTTTCCTGCGGAATAGCTCCGGGAAACTGGAATTAATACCGCATACGCCCTACGGGGGAAAGATTTATCGGGGAAGGATTGGCCCGCGTTGGATTAGCTAGTTGGTGGGGTAAAGGCCTACCAAGGCGACGATCCATAGCTGGTCTGAGAGGATGATCAGCCACATTGGGACTGAGACACGGCCCAAACTCCTACGGGAGGCAGCAGTGGGGAATATTGGACAATGGGCGCAAGCCTGATCCAGCCATGCCGCGTGAGTGATGAAGGCCTTAGGGTTGTAAAGCTCTTTCACCGGAGAAGATAATGACGGTATCCGGAGAAGAAGCCCCGGCTAACTT","Agrobacterium",
                                                 ifelse(Sequence%in%c("TTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAACGGTAGCACAGAGAGCTTGCTCTCGGGTGACGAGTGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATAACGTCGCAAGACCAAAGAGGGGGACCTTCGGGCCTCTTGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAACGGCTCACCTAGGCGACGATCCCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGGGGAGGAAGGCGGTGAGGTTAATAACCTCATCGATTGACGTTACCCGCAGAAGAAGCACCGGCTAACTC",
                                                                      "TTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAACGGTAGCACAGAGAGCTTGCTCTCGGGTGACGAGTGGCGGACGGGTGAGTAATGTCTGGGAAACTACCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATAACGTCGCAAGACCAAAGAGGGGGACCTTCGGGCCTCTTGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAACGGCTCACCTAGGCGACGATCCCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGGGGAGGAAGGCGGTGAGGTTAATAACCTCATCGATTGACGTTACCCGCAGAAGAAGCACCGGCTAACTC"),"Enterobacter",
                                                        ifelse(Sequence=="ACGAACGCTGGCGGCGTGCTTAACACATGCAAGTCGAACGAGACAATTAAAAGCTTGCTTTTAAACGTCGAGTGGCAAACGGGTGAGTAACGCGTAGACAACCTGCCGCAAAGATGGGGACAACAGTTCGAAAGGACTGCTAATACCGAATGTTCTGGAAGTTCCGCATGGAAATTCCAGCAAAGATGGCCTCTACTTGTAAGCGATCGCTTTGCGATGGGTCTGCGTCTGATTAGCTAGTTGGTGGGGCAAGGGCCTACCAAGGCGACGATCAGTAGCCGGTCTGAGAGGATGAACGGCCACATTGGGACTGAGACACGGCCCAGACTCCTACGGGAGGCAGCAGTGGGGAATCTTCCGCAATGGGCGAAAGCCTGACGGAGCAACGCCGCGTGAGTGAAGAAGGTCTTCGGATCGTAAAGCTCTGTTGCCGGGGACGAATGTAGGCAATGCAAACAGCATTGTGTAATGACGGTACCCGGCGAGGAAGCCACGGCTAACTA","Mitsuokella",
                                                               Genus)))))
df.taxRaw$Species <- with(df.taxRaw, ifelse(Sequence=="ACGAACGCTGGCGGCGTGCTTAACACATGCAAGTCGAGCGATGAAGCTTCCTTCGGGAAGTGGATTAGCGGCGGACGGGTGAGTAACACGTGGGTAACCTGCCTCAAAGTGGGGGATAGCCTTCCGAAAGGAAGATTAATACCGCATAATATGAGAGAATCGCATGATTTTCTTATCAAAGATTTATTGCTTTGAGATGGACCCGCGGCGCATTAGCTAGTTGGTAAGGTAACGGCTTACCAAGGCAACGATGCGTAGCCGACCTGAGAGGGTGATCGGCCACATTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCGCAATGGGGGAAACCCTGACGCAGCAACGCCGCGTGGGTGATGAAGGTCTTCGGATTGTAAAGCCCTGTTTTCTGGGACGATAATGACGGTACCAGAGGAGGAAGCCACGGCTAACTA","botulinum",
                                            ifelse(Sequence=="ACGAACGCTGGCGGCGTGCCTAACACATGCAAGTCGAGCGATGAAGCTCCTTCGGGAGTGAATTAGCGGCGGACGGGTGAGTAACACGTGGGTAACCTGCCTCATAGAGGGGAATAGCCTCCCGAAAGGGAGATTAATACCGCATAAAGTATGAAGGTCGCATGACTTTTATACCAAAGGAGCAATCCGCTATGAGATGGACCCGCGGCGCATTAGCTAGTTGGTGAGGTAAGGGCTCACCAAGGCAACGATGCGTAGCCGACCTGAGAGGGTGATCGGCCACATTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCGCAATGGGGGAAACCCTGACGCAGCAACGCCGCGTGAATGAAGAAGGCCTTAGGGTTGTAAAGTTCTGTCATATGGGAAGATAATGACGGTACCATATGAGGAAGCCACGGCTAACTA","argentinense",
                                                   ifelse(Sequence=="TTGAACGCTAGCGGGATGCCTTACACATGCAAGTCGAACGGCAGCACGGACTTCGGTCTGGTGGCGAGTGGCGAACGGGTGAGTAATGTATCGGAACGTGCCCAGTAGCGGGGGATAACTACGCGAAAGCGTAGCTAATACCGCATACGCCCTACGGGGGAAAGCAGGGGATCGCAAGACCTTGCACTATTGGAGCGGCCGATATCGGATTAGCTAGTTGGTGGGGTAACGGCTCACCAAGGCGACGATCCGTAGCTGGTTTGAGAGGACGACCAGCCACACTGGGACTGAGACACGGCCCAGACTCCTACGGGAGGCAGCAGTGGGGAATTTTGGACAATGGGGGAAACCCTGATCCAGCCATCCCGCGTGTGCGATGAAGGCCTTCGGGTTGTAAAGCACTTTTGGCAGGAAAGAAACGTCGTGGGTTAATACCCCGCGAAACTGACGGTACCTGCAGAATAAGCACCGGCTAACTA","xylosoxidans",
                                                          ifelse(Sequence=="ACGAACGCTGGCGGCATGCCTAACACATGCAAGTCGAACGAAGCCTTCGGGCTTAGTGGCGCACGGGTGCGTAACGCGTGGGAATCTGCCCTTGGGTTCGGAATAACAGTTAGAAATGACTGCTAATACCGGATGATGTCTTCGGACCAAAGATTTATCGCCCAAGGATGAGCCCGCGTAGGATTAGCTAGTTGGTGAGGTAAAGGCTCACCAAGGCGACGATCCTTAGCTGGTCTGAGAGGATGATCAGCCACACTGGGACTGAGACACGGCCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGGACAATGGGCGAAAGCCTGATCCAGCAATGCCGCGTGAGTGATGAAGGCCTTAGGGTTGTAAAGCTCTTTTACCCGGGATGATAATGACAGTACCGGGAGAATAAGCCCCGGCTAACTC","humi",
                                                                 ifelse(Sequence=="ACGAACGCTGGCGGCAGGCTTAACACATGCAAGTCGAACGCCCCGCAAGGGGAGTGGCAGACGGGTGAGTAACGCGTGGGAACATACCCTTTCCTGCGGAATAGCTCCGGGAAACTGGAATTAATACCGCATACGCCCTACGGGGGAAAGATTTATCGGGGAAGGATTGGCCCGCGTTGGATTAGCTAGTTGGTGGGGTAAAGGCCTACCAAGGCGACGATCCATAGCTGGTCTGAGAGGATGATCAGCCACATTGGGACTGAGACACGGCCCAAACTCCTACGGGAGGCAGCAGTGGGGAATATTGGACAATGGGCGCAAGCCTGATCCAGCCATGCCGCGTGAGTGATGAAGGCCTTAGGGTTGTAAAGCTCTTTCACCGGAGAAGATAATGACGGTATCCGGAGAAGAAGCCCCGGCTAACTT","tumefaciense",
                                                                        ifelse(Sequence%in%c("TTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAACGGTAGCACAGAGAGCTTGCTCTCGGGTGACGAGTGGCGGACGGGTGAGTAATGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATAACGTCGCAAGACCAAAGAGGGGGACCTTCGGGCCTCTTGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAACGGCTCACCTAGGCGACGATCCCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGGGGAGGAAGGCGGTGAGGTTAATAACCTCATCGATTGACGTTACCCGCAGAAGAAGCACCGGCTAACTC",
                                                                                             "TTGAACGCTGGCGGCAGGCCTAACACATGCAAGTCGAACGGTAGCACAGAGAGCTTGCTCTCGGGTGACGAGTGGCGGACGGGTGAGTAATGTCTGGGAAACTACCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCATAACGTCGCAAGACCAAAGAGGGGGACCTTCGGGCCTCTTGCCATCAGATGTGCCCAGATGGGATTAGCTAGTAGGTGGGGTAACGGCTCACCTAGGCGACGATCCCTAGCTGGTCTGAGAGGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCTTCGGGTTGTAAAGTACTTTCAGCGGGGAGGAAGGCGGTGAGGTTAATAACCTCATCGATTGACGTTACCCGCAGAAGAAGCACCGGCTAACTC"),"bugandensis",
                                                                               Species)))))))
### Correct a few missed Staphylococcus species
df.taxRaw$Species <- with(df.taxRaw, ifelse(Sequence=="TGGCTCAGGATGAACGCTGGCGGCGTGCCTAATACATGCAAGTCGAGCGAACAGACGAGGAGCTTGCTCCTTTGACGTTAGCGGCGGACGGGTGAGTAACACGTGGGTAACCTACCTATAAGACTGGGATAACTTCGGGAAACCGGAGCTAATACCGGATAATATTTCGAACCGCATGGTTCGATAGTGAAAGATGGCTTTGCTATCACTTATAGATGGACCTGCGCCGTATTAGCTAGTTGGTAAGGTAACGGCTTACCAAGGCAACGATACGTAGCCGACCTGAGAGGGTGATCGGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTAGGGAATCTTCCGCAATGGGCGAAAGCCTGACGGAGCAACGCCGCGTGAGTGATGAAGGTCTTCGGATCGTAAAACTCTGTTATTAGGGAAGAACAAACGTGTAAGTAACTGTGCACGTCTTGACGGTACCTAATCAGAAAGCCACGGCTAACTACGTGCCAGC","hominis",
                                            ifelse(Sequence=="TGGCTCAGGATGAACGCTGGCGGCGTGCCTAATACATGCAAGTCGAGCGAACAGACGAGGAGCTTGCTCCTCTGACGTTAGCGGCGGACGGGTGAGTAACACGTGGATAACCTACCTATAAGACTGGGATAACTTCGGGAAACCGGAGCTAATACCGGATAACATGTTGAACCGCATGGTTCAACAGTGAAAGACGGTCTTGCTGTCACTTATAGATGGATCCGCGCCGCATTAGCTAGTTGGTAAGGTAACGGCTTACCAAGGCAACGATGCGTAGCCGACCTGAGAGGGTGATCGGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTAGGGAATCTTCCGCAATGGGCGAAAGCCTGACGGAGCAACGCCGCGTGAGTGAAGAAGGTCTTCGGATCGTAAAACTCTGTTATTAGGGAAGAACAAATGTGTAAGTAACTATGCACGTCTTGACGGTACCTAATCAGAAAGCCACGGCTAACTACGTGCCAGC","capitis",
                                                   ifelse(Sequence=="ATGAACGCTGGCGGCGTGCCTAATACATGCAAGTCGAGCGAACAGACGAGGAGCTTGCTCCTCTGACGTTAGCGGCGGACGGGTGAGTAACACGTGGATAACCTACCTATAAGACTGGGATAACTTCGGGAAACCGGAGCTAATACCGGATAACATGTTGAACCGCATGGTTCAACAGTGAAAGACGGTCTTGCTGTCACTTATAGATGGATCCGCGCCGCATTAGCTAGTTGGTAAGGTAACGGCTTACCAAGGCAACGATGCGTAGCCGACCTGAGAGGGTGATCGGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTAGGGAATCTTCCGCAATGGGCGAAAGCCTGACGGAGCAACGCCGCGTGAGTGAAGAAGGTCTTCGGATCGTAAAACTCTGTTATTAGGGAAGAACAAATGTGTAAGTAACTATGCACGTCTTGACGGTACCTAATCAGAAAGCCACGGCTAACTA","capitis",
                                                          ifelse(Sequence=="TGGCTCAGGATGAACGCTGGCGGCGTGCCTAATACATGCAAGTCGAGCGAACAGACGAGGAGCTTGCTCCTCTGACGTTAGCGGCGGACGGGTGAGTAACACGTGGATAACCTACCTATAAGACTGGGATAACTTCGGGAAACCGGAGCTAATACCGGATAACATGTTGAACCGCATGGTTCAACAGTGAAAGACGGTCTTGCTGTCACTTATAGATGGATCCGCGCCGCATTAGCTAGTTGGTAAGGTAACGGCTTACCAAGGCAACGATGCGTAGCCGACCTGAGAGGGTGATCGGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTAGGGAATCTTCCGCAATGGGCGAAAGCCTGACGGAGCAACGCCGCGTGAGTGATGAAGGTCTTCGGATCGTAAAACTCTGTTATTAGGGAAGAACAAATGTGTAAGTAACTATGCACGTCTTGACGGTACCTAATCAGAAAGCCACGGCTAACTACGTGCCAGC","caprae",
                                                                 ifelse(Sequence=="ATGAACGCTGGCGGCGTGCCTAATACATGCAAGTCGAGCGAACAGACGAGGAGCTTGCTCCTCTGACGTTAGCGGCGGACGGGTGAGTAACACGTGGATAACCTACCTATAAGACTGGGATAACTTCGGGAAACCGGAGCTAATACCGGATAACATGTTGAACCGCATGGTTCAACAGTGAAAGACGGTCTTGCTGTCACTTATAGATGGATCCGCGCCGCATTAGCTAGTTGGTAAGGTAACGGCTTACCAAGGCAACGATGCGTAGCCGACCTGAGAGGGTGATCGGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTAGGGAATCTTCCGCAATGGGCGAAAGCCTGACGGAGCAACGCCGCGTGAGTGATGAAGGTCTTCGGATCGTAAAACTCTGTTATTAGGGAAGAACAAATGTGTAAGTAACTATGCACGTCTTGACGGTACCTAATCAGAAAGCCACGGCTAACTA","caprae",
                                                                        ifelse(Sequence=="TGGCTCAGGATGAACGCTGGCGGCGTGCCTAATACATGCAAGTCGAGCGAACAGACAAGGAGCTTGCTCCTTTGACGTTAGCGGCGGACGGGTGAGTAACACGTGGGTAACCTACCTATAAGACTGGGATAACTTCGGGAAACCGGAGCTAATACCGGATAATATTTCGAACCGCATGGTTCGATAGTGAAAGATGGTTTTGCTATCACTTATAGATGGACCCGCGCCGTATTAGCTAGTTGGTAAGGTAACGGCTTACCAAGGCGACGATACGTAGCCGACCTGAGAGGGTGATCGGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTAGGGAATCTTCCGCAATGGGCGAAAGCCTGACGGAGCAACGCCGCGTGAGTGATGAAGGTCTTCGGATCGTAAAACTCTGTTATTAGGGAAGAACATACATGTAAGTAACTATGCACGTCTTGACGGTACCTAATCAGAAAGCCACGGCTAACTACGTGCCAGC","haemolyticus",
                                                                               ifelse(Sequence=="ATGAACGCTGGCGGCGTGCCTAATACATGCAAGTCGAGCGAACAGACAAGGAGCTTGCTCCTTTGACGTTAGCGGCGGACGGGTGAGTAACACGTGGGTAACCTACCTATAAGACTGGGATAACTTCGGGAAACCGGAGCTAATACCGGATAATATTTCGAACCGCATGGTTCGATAGTGAAAGATGGTTTTGCTATCACTTATAGATGGACCCGCGCCGTATTAGCTAGTTGGTAAGGTAACGGCTTACCAAGGCGACGATACGTAGCCGACCTGAGAGGGTGATCGGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTAGGGAATCTTCCGCAATGGGCGAAAGCCTGACGGAGCAACGCCGCGTGAGTGATGAAGGTCTTCGGATCGTAAAACTCTGTTATTAGGGAAGAACATACATGTAAGTAACTATGCACGTCTTGACGGTACCTAATCAGAAAGCCACGGCTAACTA","haemolyticus",
                                                                                      ifelse(Sequence=="ATGAACGCTGGCGGCGTGCCTAATACATGCAAGTCGAGCGAACAGATAAGGAGCTTGCTCCTTTGACGTTAGCGGCGGACGGGTGAGTAACACGTGGGTAACCTACCTATAAGACTGGGACAACTTCGGGAAACCGGAGCTAATACCGGATAATATGTTGAACCGCATGGTTCAATAGTGAAAGATGGTTTTGCTATCACTTATAGATGGACCCGCGCCGTATTAGCTAGTTGGTGAGGTAACGGCTCACCAAGGCAACGATACGTAGCCGACCTGAGAGGGTGATCGGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTAGGGAATCTTCCGCAATGGGCGAAAGCCTGACGGAGCAACGCCGCGTGAGTGATGAAGGTCTTAGGATCGTAAAACTCTGTTATTAGGGAAGAACAAACGTGTAAGTAACTGTGCACGTCTTGACGGTACCTAATCAGAAAGCCACGGCTAACTA","lugdunensis",
                                                                                             Species)))))))))
physeqR <- phyloseq(tax_table(as.matrix(df.taxRaw)),otu_table(physeqR),sample_data(physeqR)) # return corrected taxonomy data to phyloseq object

#######################################
##### add columns to mapping data #####
#######################################
df.map <- as.data.frame(sample_data(physeqR))
df.map$study_id_tp <- with(df.map, ifelse(timepoint=="baseline",paste(study_id,"base"),
                                          ifelse(timepoint=="follow-up",paste(study_id,"fu"),
                                                 paste(Control,I5_Index_ID, I7_Index_ID))))
df.map$sampleID <- rownames(df.map) # sample names
df.map$LibrarySize <- sample_sums(physeqR) # total reads count per sample
df.map$AnimalReads <- sample_sums(subset_taxa(physeqR, Kingdom=="Animalia")) # total animal reads per sample
df.map$BacteriaReads <- sample_sums(subset_taxa(physeqR, Kingdom=="Bacteria")) # total bacteria reads per sample
df.map$RatioReads <- df.map$BacteriaReads / df.map$AnimalReads # ratio of bacteria reads:animal reads per sample
df.map$BacteriaPercent <- df.map$BacteriaReads / df.map$LibrarySize # percent of total reads that are bacteria
df.map$AnimalPercent <- df.map$AnimalReads / df.map$LibrarySize # percent of total reads that are animal
df.map$RatioPercent <- df.map$BacteriaPercent / df.map$AnimalPercent # ratio of bacteria reads:animal reads per sample
physeqR = phyloseq(tax_table(as.matrix(df.taxRaw)),otu_table(physeqR),sample_data(df.map)) # return map to phyloseq object

########################################################################################
##### save phyloseq object and its components for easy access in future processing #####
########################################################################################
save(physeqR,file=("outputPrelim/physeqR.RData")) # Save the phyloseq data object in a .RData file 
write.csv(tax_table(physeqR),"outputPrelim/table_tax.csv") # Save taxonomy table as .csv
write.csv(otu_table(physeqR),"outputPrelim/table_otu.csv") # Save ASV table as .csv
write.csv(sample_data(physeqR),"outputPrelim/table_mapModified.csv") # Save modified sample data as .csv

#load("outputPrelim/physeq_initial.RData")
phyR.bacteria <- subset_taxa(physeqR,Kingdom=="Bacteria")
write.csv(tax_table(phyR.bacteria),"outputPrelim/table_taxaBacteria.csv")
write.csv(otu_table(phyR.bacteria),"outputPrelim/table_otuBacteria.csv")

phyT.bacteria <- transform_sample_counts(phyR.bacteria, function(x) x/sum(x)) # transform counts to abundance
otu_table(phyT.bacteria)[is.na(otu_table(phyT.bacteria))] <- 0 # replace missing counts with 0
write.csv(tax_table(phyT.bacteria),"outputPrelim/table_taxaBacteriaTransform.csv") # Save bacteria taxonomy table as .csv
write.csv(otu_table(phyT.bacteria),"outputPrelim/table_otuBacteriaTransform.csv") # Save ASV table as .csv

##########################################################################################################
##### You have now successfully imported all the raw data into R and performed preliminary clean-up. #####
##### You are ready to proceed with further analysis                                                 #####
##########################################################################################################
##### All code written by Emily Ann McClure. No AI was used at any stage in writing or editing this code. 
